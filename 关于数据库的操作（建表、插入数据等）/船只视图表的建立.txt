CREATE VIEW `联合证书视图` AS
SELECT 
    a.船名,
    a.船检登记号,
    a.船舶所有人,
    a.船舶登记号,
    a.国籍配员证书编号,
    a.下次换证时间 AS 国籍配员下次换证时间,
    a.换证通知时间 AS 国籍配员换证通知时间,
    a.国籍配员证书使用有效期至,
    a.发证日期 AS 国籍配员发证日期,
    a.国籍配员证书换证时间记录,
    b.安检证书编号,
    b.检查机关,
    b.下次检查时间,
    b.通知时间 AS 安检通知时间,
    b.安检证书使用有效期至 AS 安检证书有效期至,
    b.发证日期 AS 安检证书发证日期,
    b.船只检验情况记录 AS 安检情况记录,
    c.检验证编号,
    c.船舶检验类型,
    c.下次检验时间 AS 检验证下次检验时间,
    c.通知时间 AS 检验证通知时间,
    c.检验机关 AS 检验证检验机关,
    c.检验证使用有效期至,
    c.发证日期 AS 检验证发证日期,
    c.船只检验情况记录 AS 检验证情况记录,
    d.营运证编号,
    d.经营人许可证号码,
    d.管理人许可证号码,
    d.发证机关 AS 营运证发证机关,
    d.营运证使用有效期至,
    d.发证日期 AS 营运证发证日期
FROM 
    `国籍配员证书基本信息表` a
LEFT JOIN 
    `船只安检证书基本表` b ON a.船名 = b.船名 AND a.船检登记号 = b.船检登记号
LEFT JOIN
    `船只检验证书基本表` c ON a.船名 = c.船名 AND a.船检登记号 = c.船检登记号
LEFT JOIN
    `船只营运证书基本表` d ON a.船名 = d.船名 AND a.船检登记号 = d.船检登记号;








CREATE VIEW 船只缴费总览视图 AS
SELECT a.船名, 
       a.船检登记号, 
       a.航道费, 
       a.填表日期 AS 航道费填表日期, 
       a.航道费合计, 
       a.航道费缴纳记录,
       b.填表日期 AS 水运费填表日期,
       b.水运费合计,
       b.水运费缴纳记录
FROM 航道费缴纳情况表 a
LEFT JOIN 船只按月缴纳水运费基本信息表 b ON a.船名 = b.船名 AND a.船检登记号 = b.船检登记号;

















CREATE VIEW `证书有效期和办理时间视图` AS
SELECT 
    a.`船名` AS '船名',
    MAX(a.`办理日期`) AS '中间检验办理日期',
    MAX(a.`证书有效期至`) AS '中间检验证书有效期至',
    MAX(b.`办理日期`) AS '危险品办理日期',
    MAX(b.`证书有效期至`) AS '危险品证书有效期至',
    MAX(c.`证书有效期至`) AS '各证书有效期至',
    MAX(d.`办理日期`) AS '国籍证书办理日期',
    MAX(d.`证书有效期至`) AS '国籍证书有效期至',
    MAX(e.`办理日期`) AS '坞内检验办理日期',
    MAX(e.`证书有效期至`) AS '坞内检验证书有效期至',
    MAX(f.`办理日期`) AS '油污证书办理日期',
    MAX(f.`证书有效期至`) AS '油污证书有效期至',
    MAX(g.`办理日期`) AS '港澳证明办理日期',
    MAX(g.`证书有效期至`) AS '港澳证明有效期至'
FROM 
    `中间检验处理历史表` a
LEFT JOIN 
    `危险品证书处理历史表` b ON a.`船名` = b.`船名`
LEFT JOIN
    `各证书有效期` c ON a.`船名` = c.`船名`
LEFT JOIN
    `国籍证书处理历史表` d ON a.`船名` = d.`船名`
LEFT JOIN
    `坞内检验处理历史表` e ON a.`船名` = e.`船名`
LEFT JOIN
    `油污证书处理历史表` f ON a.`船名` = f.`船名`
LEFT JOIN 
    `港澳证明处理历史表` g ON a.`船名` = g.`船名`
GROUP BY a.`船名`;







CREATE VIEW 船只信息总览 AS
SELECT 
    基.船名,
    基.船主姓名,
    基.身份证号,
    基.联系电话,
    基.详细住址,
    基.船舶类型,
    基.船籍港,
    基.建造厂,
    基.总长,
    基.型宽,
    基.型深,
    基.总吨,
    基.净吨,
    基.主机功率,
    基.载重吨,
    基.航行区域,
    基.备注,
    基.船检登记号,
    营.营运证编号,
    营.发证机关,
    检.检验证编号,
    检.船舶检验类型,
    安.安检证书编号,
    安.检查机关,
    配.国籍配员证书编号,
    航.航道费,
    航.航道费合计,
    水.水运费合计,
    水.水运费缴纳记录
FROM 
    船只基本资料表 基
LEFT JOIN 
    船只营运证书基本表 营 ON 基.船名 = 营.船名 AND 基.船检登记号 = 营.船检登记号
LEFT JOIN 
    船只检验证书基本表 检 ON 基.船名 = 检.船名 AND 基.船检登记号 = 检.船检登记号
LEFT JOIN 
    船只安检证书基本表 安 ON 基.船名 = 安.船名 AND 基.船检登记号 = 安.船检登记号
LEFT JOIN 
    国籍配员证书基本信息表 配 ON 基.船名 = 配.船名 AND 基.船检登记号 = 配.船检登记号
LEFT JOIN 
    航道费缴纳情况表 航 ON 基.船名 = 航.船名 AND 基.船检登记号 = 航.船检登记号
LEFT JOIN 
    船只按月缴纳水运费基本信息表 水 ON 基.船名 = 水.船名 AND 基.船检登记号 = 水.船检登记号;
